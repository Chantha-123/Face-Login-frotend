<div class="login-container fade-in-up">
    <div class="card">
        <div class="card-header">
            <h2>üîê Face Login</h2>
            <p>Login using facial recognition technology</p>
        </div>

        <div class="card-body">
            <!-- Camera Activation Section -->
            <div class="section" ng-if="loginCtrl.cameraAvailable">
                <h3>üì∑ Camera Login</h3>
                
                <!-- Camera Placeholder (when not active) -->
                <div class="camera-placeholder" ng-click="loginCtrl.openCamera()" 
                     ng-if="!loginCtrl.isCameraActive && !loginCtrl.capturedImage">
                    <div>
                        <div style="font-size: 48px; margin-bottom: 10px;">üì∏</div>
                        <div>Click to Open Camera</div>
                        <div style="font-size: 12px; opacity: 0.7; margin-top: 5px;">
                            Capture your face for login
                        </div>
                    </div>
                </div>

                <!-- Active Camera View -->
                <div class="camera-container" ng-if="loginCtrl.isCameraActive && !loginCtrl.capturedImage">
                    <div class="video-wrapper">
                        <video id="loginVideo" autoplay muted playsinline></video>
                        <div class="capture-overlay"></div>
                    </div>
                    
                    <div class="controls">
                        <button class="btn btn-success" 
                                ng-click="loginCtrl.captureImage()" 
                                ng-disabled="loginCtrl.loading">
                            <span ng-if="!loginCtrl.loading">üì∏ Capture</span>
                            <span ng-if="loginCtrl.loading" class="loading"></span>
                        </button>
                        
                        <button class="btn btn-outline" 
                                ng-click="loginCtrl.closeCamera()"
                                ng-disabled="loginCtrl.loading">
                            ‚ùå Close
                        </button>
                    </div>
                </div>
            </div>

            <!-- Captured Image Preview -->
            <div class="section" ng-if="loginCtrl.capturedImage">
                <h3>‚úÖ Face Captured</h3>
                <div class="text-center">
                    <img ng-src="{{loginCtrl.capturedImage}}" alt="Captured face" class="preview-image">
                    <div class="controls">
                        <button class="btn btn-warning" 
                                ng-click="loginCtrl.retakeImage()">
                            üîÑ Retake Photo
                        </button>
                    </div>
                </div>
            </div>

            <!-- File Upload Section -->
            <div class="section">
                <h3>üìÅ Upload Image</h3>
                <p style="text-align: center; margin-bottom: 15px; opacity: 0.8;">
                    Or upload a face image from your device
                </p>
                <div class="file-upload">
                    <input type="file" file-model="loginCtrl.faceImage" 
                           on-file-select="loginCtrl.onFileSelect(file)" 
                           accept="image/*" class="file-input">
                </div>
            </div>

            <!-- Camera Error Message -->
            <div class="alert alert-warning" ng-if="loginCtrl.cameraError">
                <strong>‚ö†Ô∏è Camera Not Available</strong><br>
                Please use file upload instead or check camera permissions.
            </div>

            <!-- Action Buttons -->
            <div class="controls">
                <button class="btn btn-primary btn-lg" 
                        ng-click="loginCtrl.login()" 
                        ng-disabled="loginCtrl.loading || !loginCtrl.faceImage">
                    <span ng-if="!loginCtrl.loading">üîì Login with Face</span>
                    <span ng-if="loginCtrl.loading">
                        <span class="loading"></span> Verifying...
                    </span>
                </button>
            </div>

            <!-- Register Link -->
            <div class="auth-link">
                <p>Don't have an account? 
                    <a href="#/register" ng-click="loginCtrl.goToRegister()">
                        <strong>Register here</strong>
                    </a>
                </p>
            </div>
        </div>
    </div>

    <!-- Messages -->
    <div class="alert" 
         ng-class="{
             'alert-success': loginCtrl.isSuccess, 
             'alert-danger': !loginCtrl.isSuccess && loginCtrl.message,
             'alert-info': !loginCtrl.message
         }" 
         ng-if="loginCtrl.message || loginCtrl.loading">
        <div ng-if="loginCtrl.loading && !loginCtrl.message">
            <span class="loading"></span> Processing...
        </div>
        <div ng-if="loginCtrl.message">{{loginCtrl.message}}</div>
    </div>

    <!-- Add this in the camera section -->
<div class="alert alert-info" ng-if="loginCtrl.checkingCamera">
    <span class="loading"></span> Checking camera availability...
</div>
</div>