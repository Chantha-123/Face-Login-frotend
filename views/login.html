<div class="login-container fade-in-up" ng-controller="LoginController as loginCtrl">
  <div class="card">
    <div class="card-header">
      <h2>🔐 Face Login</h2>
      <p>Login using facial recognition technology</p>
    </div>

    <div class="card-body">

      <!-- Camera Activation Section -->
      <div class="section" ng-if="loginCtrl.cameraAvailable">
        <h3>📷 Face Scan</h3>

        <!-- Camera Placeholder -->
        <div class="camera-placeholder"
             ng-click="loginCtrl.openCamera()"
             ng-if="!loginCtrl.isCameraActive && !loginCtrl.capturedImage">
          <div>
            <div style="font-size: 48px;">📸</div>
            <div>Click to Start Face Scan</div>
            <small style="opacity: 0.7;">Allow camera access when prompted</small>
          </div>
        </div>

        <!-- Active Camera View -->
        <div class="camera-container"
             ng-if="loginCtrl.isCameraActive && !loginCtrl.capturedImage">
          <div class="video-wrapper">
            <video id="loginVideo" autoplay muted playsinline></video>
            <div class="face-frame-style-login"></div>
          </div>

          <!-- Scanning / Auto Capture Status -->
          <div class="scanning-status" ng-if="loginCtrl.isCameraActive">
            <span class="loading"></span> Scanning face, please hold still...
          </div>

          <!-- <div class="controls">
            <button class="btn btn-success" ng-click="loginCtrl.captureImage()">📸 Capture</button>
            <button class="btn btn-outline" ng-click="loginCtrl.closeCamera()">❌ Close</button>
          </div> -->
        </div>
      </div>

      <!-- Captured Image Preview -->
      <div class="section" ng-if="loginCtrl.capturedImage">
        <h3>✅ Face Captured</h3>
        <div class="text-center">
          <img ng-src="{{loginCtrl.capturedImage}}" alt="Captured face" class="preview-image">
          <div class="controls">
            <button class="btn btn-warning" ng-click="loginCtrl.retakeImage()">🔄 Rescan</button>
          </div>
        </div>
      </div>

      <!-- Upload Section -->
      <div class="section">
        <h3>📁 Upload Face Image</h3>
        <p style="text-align: center; opacity: 0.8;">Or upload a face image manually</p>
        <input type="file"
               file-model="loginCtrl.faceImage"
               on-file-select="loginCtrl.onFileSelect(file)"
               accept="image/*"
               class="file-input">
      </div>

      <!-- Error or Info Messages -->
      <div class="alert"
           ng-class="{
             'alert-success': loginCtrl.isSuccess,
             'alert-danger': !loginCtrl.isSuccess && loginCtrl.message,
             'alert-info': loginCtrl.checkingCamera
           }"
           ng-if="loginCtrl.message || loginCtrl.checkingCamera">
        <div ng-if="loginCtrl.checkingCamera"><span class="loading"></span> Checking camera availability...</div>
        <div ng-if="!loginCtrl.checkingCamera">{{loginCtrl.message}}</div>
      </div>

      <!-- Login Button -->
      <div class="controls">
        <button class="btn btn-primary btn-lg"
                ng-click="loginCtrl.login()"
                ng-disabled="loginCtrl.loading || !loginCtrl.faceImage">
          <span ng-if="!loginCtrl.loading">🔓 Login with Face</span>
          <span ng-if="loginCtrl.loading"><span class="loading"></span> Verifying...</span>
        </button>
      </div>

      <!-- Register Link -->
      <div class="auth-link">
        <p>Don't have an account?
          <a href="#/register" ng-click="loginCtrl.goToRegister()"><strong>Register here</strong></a>
        </p>
      </div>

    </div>
  </div>
</div>
